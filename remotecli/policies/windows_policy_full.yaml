version: "2024.11-full"
os: "windows"
rules:
  - id: "WIN-ACC-001"
    control_id: "WIN.ACC.MINLEN"
    category: "Account Policies"
    description: "Minimum password length >=12"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(net accounts) -match 'Minimum password length' -replace '\\D','' -as [int] -ge 12"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "net accounts /minpwlen:12"]
    severity: "high"
    os: "windows"
  - id: "WIN-ACC-002"
    control_id: "WIN.ACC.HISTORY"
    category: "Account Policies"
    description: "Password history >=24"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(net accounts) -match 'Password history length' -replace '\\D','' -as [int] -ge 24"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "net accounts /uniquepw:24"]
    severity: "high"
    os: "windows"
  - id: "WIN-ACC-003"
    control_id: "WIN.ACC.MAXAGE"
    category: "Account Policies"
    description: "Maximum password age <=90 days"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(net accounts) -match 'Maximum password age' | ForEach-Object {($_ -split ':')[1].Trim()} | ForEach-Object {[timespan]::Parse($_).Days -le 90}"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "net accounts /maxpwage:90"]
    severity: "medium"
    os: "windows"
  - id: "WIN-ACC-004"
    control_id: "WIN.ACC.COMPLEXITY"
    category: "Account Policies"
    description: "Password complexity enabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; Select-String -Path $cfg -Pattern 'PasswordComplexity\\s*=\\s*1'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa' -Name 'PasswordComplexity' -Value 1"]
    severity: "high"
    os: "windows"
  - id: "WIN-ACC-005"
    control_id: "WIN.ACC.REVENC"
    category: "Account Policies"
    description: "Reversible encryption disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; Select-String -Path $cfg -Pattern 'ClearTextPassword\\s*=\\s*0'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa' -Name 'ClearTextPassword' -Value 0"]
    severity: "high"
    os: "windows"
  - id: "WIN-ACC-006"
    control_id: "WIN.ACC.MINAGE"
    category: "Account Policies"
    description: "Minimum password age >= 1 day"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(net accounts) -match 'Minimum password age' | ForEach-Object {($_ -split ':')[1].Trim()} | ForEach-Object {[timespan]::Parse($_).Days -ge 1}"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "net accounts /minpwage:1"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SEC-001"
    control_id: "WIN.SEC.GUEST"
    category: "Security Options"
    description: "Guest account disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-LocalUser -Name 'Guest').Enabled -eq $false"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Disable-LocalUser -Name 'Guest'"]
    severity: "high"
    os: "windows"
  - id: "WIN-SEC-002"
    control_id: "WIN.SEC.LEGALNOTICE"
    category: "Security Options"
    description: "Legal notice configured"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System').LegalNoticeText -ne $null"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System' -Name 'LegalNoticeText' -Value 'Authorized use only'"]
    severity: "low"
    os: "windows"
  - id: "WIN-UAC-001"
    control_id: "WIN.UAC.ADMINAPPROVAL"
    category: "UAC"
    description: "Admin approval mode enabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System').EnableLUA -eq 1"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System' -Name 'EnableLUA' -Value 1"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SVC-001"
    control_id: "WIN.SVC.REMOTEREGISTRY"
    category: "System Services"
    description: "RemoteRegistry service disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-Service RemoteRegistry).StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-Service -Name RemoteRegistry -StartupType Disabled"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SVC-002"
    control_id: "WIN.SVC.XBOX"
    category: "System Services"
    description: "Xbox services disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "('XblAuthManager','XblGameSave','XboxGipSvc','XboxNetApiSvc' | ForEach-Object {(Get-Service $_).StartType}) -notcontains 'Automatic'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "('XblAuthManager','XblGameSave','XboxGipSvc','XboxNetApiSvc' | ForEach-Object {Set-Service -Name $_ -StartupType Disabled})"]
    severity: "low"
    os: "windows"
  - id: "WIN-SVC-004"
    control_id: "WIN.SVC.BLUETOOTH"
    category: "System Services"
    description: "Bluetooth service disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-Service bthserv).StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-Service -Name bthserv -StartupType Disabled"]
    severity: "low"
    os: "windows"
  - id: "WIN-SVC-005"
    control_id: "WIN.SVC.RDP"
    category: "System Services"
    description: "Remote Desktop (TermService) disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-Service TermService).StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-Service -Name TermService -StartupType Disabled"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SVC-006"
    control_id: "WIN.SVC.WINRM"
    category: "System Services"
    description: "WinRM service disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-Service WinRM).StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-Service -Name WinRM -StartupType Disabled"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SVC-007"
    control_id: "WIN.SVC.W3SVC"
    category: "System Services"
    description: "W3SVC disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-Service W3SVC).StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-Service -Name W3SVC -StartupType Disabled"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SVC-008"
    control_id: "WIN.SVC.UPNP"
    category: "System Services"
    description: "UPnP services disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "('SSDPSRV','upnphost' | ForEach-Object {(Get-Service $_).StartType}) -notcontains 'Automatic'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "('SSDPSRV','upnphost' | ForEach-Object {Set-Service -Name $_ -StartupType Disabled})"]
    severity: "low"
    os: "windows"
  - id: "WIN-FW-001"
    control_id: "WIN.FW.ON"
    category: "Firewall"
    description: "Firewall enabled on all profiles"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-NetFirewallProfile | Where-Object {$_.Enabled -eq 'True'}).Count -ge 3"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True"]
    severity: "high"
    os: "windows"
  - id: "WIN-FW-DEF-001"
    control_id: "WIN.FW.DEFAULTS"
    category: "Firewall"
    description: "Default inbound=Block, outbound=Allow"
    check_cmd: ["powershell", "-NoProfile", "-Command", "($p=Get-NetFirewallProfile) -and (($p | Where-Object {$_.DefaultInboundAction -eq 'Block'}).Count -ge 3) -and (($p | Where-Object {$_.DefaultOutboundAction -eq 'Allow'}).Count -ge 3)"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-NetFirewallProfile -Profile Domain,Public,Private -DefaultInboundAction Block -DefaultOutboundAction Allow"]
    severity: "high"
    os: "windows"
  - id: "WIN-FW-LOG-001"
    control_id: "WIN.FW.LOG"
    category: "Firewall"
    description: "Firewall logging enabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-NetFirewallProfile | Where-Object {$_.LogFileName -ne $null -and $_.LogBlocked -eq 'True' -and $_.LogAllowed -eq 'True'}).Count -ge 3"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-NetFirewallProfile -Profile Domain,Public,Private -LogFileName 'C:\\Windows\\System32\\LogFiles\\Firewall\\pfirewall.log' -LogMaxSizeKilobytes 16384 -LogAllowed True -LogBlocked True"]
    severity: "medium"
    os: "windows"
  - id: "WIN-AUDIT-001"
    control_id: "WIN.AUD.ACCOUNTLOGON"
    category: "Advanced Audit"
    description: "Audit policy: account logon events enabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'Account Logon') -match 'Success.*Enabled' -and (AuditPol /get /subcategory:'Account Logon') -match 'Failure.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'Account Logon' /success:enable /failure:enable"]
    severity: "high"
    os: "windows"
  - id: "WIN-AUDIT-002"
    control_id: "WIN.AUD.PROCESSCREATION"
    category: "Advanced Audit"
    description: "Audit process creation enabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'Process Creation') -match 'Success.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'Process Creation' /success:enable"]
    severity: "medium"
    os: "windows"
  - id: "WIN-AUDIT-003"
    control_id: "WIN.AUD.PRIVILEGEUSE"
    category: "Advanced Audit"
    description: "Audit privilege use enabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'Privilege Use') -match 'Success.*Enabled' -and (AuditPol /get /subcategory:'Privilege Use') -match 'Failure.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'Privilege Use' /success:enable /failure:enable"]
    severity: "medium"
    os: "windows"
  - id: "WIN-AUDIT-004"
    control_id: "WIN.AUD.POLICYCHANGE"
    category: "Advanced Audit"
    description: "Audit policy change enabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'Policy Change') -match 'Success.*Enabled' -and (AuditPol /get /subcategory:'Policy Change') -match 'Failure.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'Policy Change' /success:enable /failure:enable"]
    severity: "medium"
    os: "windows"
  - id: "WIN-AUDIT-005"
    control_id: "WIN.AUD.CREDVALID"
    category: "Advanced Audit"
    description: "Audit credential validation"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'Credential Validation') -match 'Success.*Enabled' -and (AuditPol /get /subcategory:'Credential Validation') -match 'Failure.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'Credential Validation' /success:enable /failure:enable"]
    severity: "high"
    os: "windows"
  - id: "WIN-AUDIT-006"
    control_id: "WIN.AUD.SECGROUPMGMT"
    category: "Advanced Audit"
    description: "Audit security group management"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'Security Group Management') -match 'Success.*Enabled' -and (AuditPol /get /subcategory:'Security Group Management') -match 'Failure.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'Security Group Management' /success:enable /failure:enable"]
    severity: "medium"
    os: "windows"
  - id: "WIN-AUDIT-007"
    control_id: "WIN.AUD.REMOVABLE"
    category: "Advanced Audit"
    description: "Audit removable storage"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'Removable Storage') -match 'Success.*Enabled' -and (AuditPol /get /subcategory:'Removable Storage') -match 'Failure.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'Removable Storage' /success:enable /failure:enable"]
    severity: "medium"
    os: "windows"
  - id: "WIN-AUDIT-008"
    control_id: "WIN.AUD.FILESHARE"
    category: "Advanced Audit"
    description: "Audit file share"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'File Share') -match 'Success.*Enabled' -and (AuditPol /get /subcategory:'File Share') -match 'Failure.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'File Share' /success:enable /failure:enable"]
    severity: "medium"
    os: "windows"
  - id: "WIN-AUDIT-009"
    control_id: "WIN.AUD.SYSINTEGRITY"
    category: "Advanced Audit"
    description: "Audit system integrity"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'System Integrity') -match 'Success.*Enabled' -and (AuditPol /get /subcategory:'System Integrity') -match 'Failure.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'System Integrity' /success:enable /failure:enable"]
    severity: "high"
    os: "windows"
  - id: "WIN-SVC-003"
    control_id: "WIN.SVC.SNMP_TELNET"
    category: "System Services"
    description: "Disable SNMP and Telnet"
    check_cmd: ["powershell", "-NoProfile", "-Command", "('SNMP','TlntSvr' | ForEach-Object {(Get-Service $_).StartType}) -notcontains 'Automatic'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "('SNMP','TlntSvr' | ForEach-Object {Set-Service -Name $_ -StartupType Disabled})"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SVC-009"
    control_id: "WIN.SVC.ICS"
    category: "System Services"
    description: "Internet Connection Sharing disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-Service SharedAccess).StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-Service -Name SharedAccess -StartupType Disabled"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SVC-010"
    control_id: "WIN.SVC.FUNCTION_DISCOVERY_PH"
    category: "System Services"
    description: "Function Discovery Provider Host disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-Service fdPHost).StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-Service -Name fdPHost -StartupType Disabled"]
    severity: "low"
    os: "windows"
  - id: "WIN-SVC-011"
    control_id: "WIN.SVC.FUNCTION_DISCOVERY_RP"
    category: "System Services"
    description: "Function Discovery Resource Publication disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-Service FDResPub).StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-Service -Name FDResPub -StartupType Disabled"]
    severity: "low"
    os: "windows"
  - id: "WIN-SVC-012"
    control_id: "WIN.SVC.WMP_NETWORK"
    category: "System Services"
    description: "Windows Media Network Sharing Service disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-Service WMPNetworkSvc).StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-Service -Name WMPNetworkSvc -StartupType Disabled"]
    severity: "low"
    os: "windows"
  - id: "WIN-SEC-003"
    control_id: "WIN.SEC.BLOCK_MS_ACCOUNTS"
    category: "Security Options"
    description: "Block Microsoft accounts"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System').NoConnectedUser -eq 3"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System' -Name 'NoConnectedUser' -Value 3"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SEC-004"
    control_id: "WIN.SEC.CTRL_ALT_DEL"
    category: "Security Options"
    description: "CTRL+ALT+DEL required"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System').DisableCAD -eq 0"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System' -Name 'DisableCAD' -Value 0"]
    severity: "low"
    os: "windows"
  - id: "WIN-SEC-005"
    control_id: "WIN.SEC.LIMIT_BLANK_PASSWORD"
    category: "Security Options"
    description: "Limit blank password use"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa').LimitBlankPasswordUse -eq 1"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa' -Name 'LimitBlankPasswordUse' -Value 1"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SEC-006"
    control_id: "WIN.SEC.RENAME_ADMIN"
    category: "Security Options"
    description: "Administrator account renamed"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-LocalUser -SID 'S-1-5-21-*-500').Name -ne 'Administrator'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Rename Administrator account per policy'; exit 1"]
    severity: "low"
    os: "windows"
  - id: "WIN-SEC-007"
    control_id: "WIN.SEC.RENAME_GUEST"
    category: "Security Options"
    description: "Guest account renamed"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-LocalUser -Name 'Guest').Name -ne 'Guest'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Rename Guest account per policy'; exit 1"]
    severity: "low"
    os: "windows"
  - id: "WIN-SEC-008"
    control_id: "WIN.SEC.INACTIVITY"
    category: "Security Options"
    description: "Machine inactivity limit configured"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System').InactivityTimeoutSecs -ge 900"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System' -Name 'InactivityTimeoutSecs' -Value 900"]
    severity: "medium"
    os: "windows"
  - id: "WIN-DEF-001"
    control_id: "WIN.DEF.APPGUARD_ENABLED"
    category: "Application Guard"
    description: "Windows Defender Application Guard enabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-WindowsOptionalFeature -Online -FeatureName Windows-Defender-ApplicationGuard).State -eq 'Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Enable-WindowsOptionalFeature -Online -FeatureName Windows-Defender-ApplicationGuard -All"]
    severity: "low"
    os: "windows"
  - id: "WIN-NET-001"
    control_id: "WIN.NET.SMBV1"
    category: "Network"
    description: "SMBv1 disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-WindowsOptionalFeature -Online -FeatureName SMB1Protocol).State -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol -NoRestart"]
    severity: "high"
    os: "windows"
  - id: "WIN-LOCK-001"
    control_id: "WIN.LOCK.THRESH"
    category: "Account Lockout"
    description: "Lockout threshold <= 5"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(net accounts) -match 'Lockout threshold' -replace '\\D','' -as [int] -le 5"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "net accounts /lockoutthreshold:5"]
    severity: "high"
    os: "windows"
  - id: "WIN-LOCK-002"
    control_id: "WIN.LOCK.DURATION"
    category: "Account Lockout"
    description: "Lockout duration >= 15 minutes"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(net accounts) -match 'Lockout duration' | ForEach-Object {($_ -split ':')[1].Trim()} | ForEach-Object {[timespan]::Parse($_).Minutes -ge 15}"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "net accounts /lockoutduration:15"]
    severity: "medium"
    os: "windows"
  - id: "WIN-UAC-002"
    control_id: "WIN.UAC.SECUREDESKTOP"
    category: "UAC"
    description: "Secure desktop prompts"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System').PromptOnSecureDesktop -eq 1"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System' -Name 'PromptOnSecureDesktop' -Value 1"]
    severity: "medium"
    os: "windows"
  - id: "WIN-RIGHTS-001"
    control_id: "WIN.RIGHTS.LOCALLOGON"
    category: "Local Policies"
    description: "Allow log on locally: Administrators, Users"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; (Select-String -Path $cfg -Pattern 'SeInteractiveLogonRight').Line -match 'S-1-5-32-544' -and ((Select-String -Path $cfg -Pattern 'SeInteractiveLogonRight').Line -match 'S-1-5-32-545')"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Configure via Local Security Policy (SeInteractiveLogonRight)'; exit 1"]
    severity: "medium"
    os: "windows"
  - id: "WIN-RIGHTS-002"
    control_id: "WIN.RIGHTS.NETWORKLOGON"
    category: "Local Policies"
    description: "Access this computer from the network: Administrators, Remote Desktop Users"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; (Select-String -Path $cfg -Pattern 'SeNetworkLogonRight').Line -match 'S-1-5-32-544' -and ((Select-String -Path $cfg -Pattern 'SeNetworkLogonRight').Line -match 'S-1-5-32-555')"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Configure via Local Security Policy (SeNetworkLogonRight)'; exit 1"]
    severity: "medium"
    os: "windows"
  - id: "WIN-RIGHTS-003"
    control_id: "WIN.RIGHTS.CREDS_MANAGER"
    category: "Local Policies"
    description: "Restrict Access Credential Manager"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; -not (Select-String -Path $cfg -Pattern 'SeCredsMgrAccess')"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Set SeCredsMgrAccess to empty via Local Security Policy'; exit 1"]
    severity: "medium"
    os: "windows"
  - id: "WIN-RIGHTS-004"
    control_id: "WIN.RIGHTS.CHANGE_TIME"
    category: "Local Policies"
    description: "Change system time restricted"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; (Select-String -Path $cfg -Pattern 'SeTimeZonePrivilege').Line -match 'S-1-5-32-544'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Configure SeTimeZonePrivilege to Administrators only'; exit 1"]
    severity: "low"
    os: "windows"
  - id: "WIN-RIGHTS-005"
    control_id: "WIN.RIGHTS.DENY_LOCAL"
    category: "Local Policies"
    description: "Deny log on locally for non-admin"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; (Select-String -Path $cfg -Pattern 'SeDenyInteractiveLogonRight').Line -match 'S-1-5-32-546'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Set SeDenyInteractiveLogonRight for Guests'; exit 1"]
    severity: "low"
    os: "windows"
  - id: "WIN-RIGHTS-006"
    control_id: "WIN.RIGHTS.DENY_NETWORK"
    category: "Local Policies"
    description: "Deny log on over network for Guests"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; (Select-String -Path $cfg -Pattern 'SeDenyNetworkLogonRight').Line -match 'S-1-5-32-546'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Set SeDenyNetworkLogonRight for Guests'; exit 1"]
    severity: "low"
    os: "windows"
  - id: "WIN-RIGHTS-007"
    control_id: "WIN.RIGHTS.RDP_LOGON"
    category: "Local Policies"
    description: "Allow log on through Remote Desktop Services: Administrators, RDP Users"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; (Select-String -Path $cfg -Pattern 'SeRemoteInteractiveLogonRight').Line -match 'S-1-5-32-544' -and ((Select-String -Path $cfg -Pattern 'SeRemoteInteractiveLogonRight').Line -match 'S-1-5-32-555')"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Configure SeRemoteInteractiveLogonRight to Administrators and Remote Desktop Users'; exit 1"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SVC-013"
    control_id: "WIN.SVC.SNMP_TRAP"
    category: "System Services"
    description: "SNMP Trap service disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-Service SNMPTRAP).StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-Service -Name SNMPTRAP -StartupType Disabled"]
    severity: "low"
    os: "windows"
  - id: "WIN-SVC-014"
    control_id: "WIN.SVC.REMOTE_ACCESS"
    category: "System Services"
    description: "Routing and Remote Access disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-Service RemoteAccess).StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-Service -Name RemoteAccess -StartupType Disabled"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SVC-015"
    control_id: "WIN.SVC.RASMAN"
    category: "System Services"
    description: "Remote Access Connection Manager disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-Service RasMan).StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-Service -Name RasMan -StartupType Disabled"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SVC-016"
    control_id: "WIN.SVC.REMOTE_ASSISTANCE"
    category: "System Services"
    description: "Remote Assistance service disabled if present"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$s=Get-Service -Name RemoteAssistance -ErrorAction SilentlyContinue; $s -and $s.StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "$s=Get-Service -Name RemoteAssistance -ErrorAction SilentlyContinue; if($s){ Set-Service -Name RemoteAssistance -StartupType Disabled }"]
    severity: "low"
    os: "windows"
  - id: "WIN-LOCK-003"
    control_id: "WIN.LOCK.ADMIN"
    category: "Account Lockout"
    description: "Admin account lockout enabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Services\\RemoteAccess\\Parameters\\AccountLockout').MaxDenials -le 5"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Ensure Admin account lockout is enabled via Group Policy'; exit 1"]
    severity: "high"
    os: "windows"
  - id: "WIN-RIGHTS-008"
    control_id: "WIN.RIGHTS.BACKUP"
    category: "Local Policies"
    description: "Back up files and directories: Administrators, Backup Operators"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; (Select-String -Path $cfg -Pattern 'SeBackupPrivilege').Line -match 'S-1-5-32-544' -and ((Select-String -Path $cfg -Pattern 'SeBackupPrivilege').Line -match 'S-1-5-32-551')"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Configure SeBackupPrivilege via Local Security Policy'; exit 1"]
    severity: "medium"
    os: "windows"
  - id: "WIN-RIGHTS-009"
    control_id: "WIN.RIGHTS.RESTORE"
    category: "Local Policies"
    description: "Restore files and directories: Administrators, Backup Operators"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; (Select-String -Path $cfg -Pattern 'SeRestorePrivilege').Line -match 'S-1-5-32-544' -and ((Select-String -Path $cfg -Pattern 'SeRestorePrivilege').Line -match 'S-1-5-32-551')"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Configure SeRestorePrivilege via Local Security Policy'; exit 1"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SVC-017"
    control_id: "WIN.SVC.TELNET_CLIENT"
    category: "System Services"
    description: "Telnet Client disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-WindowsOptionalFeature -Online -FeatureName TelnetClient).State -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Disable-WindowsOptionalFeature -Online -FeatureName TelnetClient -NoRestart"]
    severity: "medium"
    os: "windows"
  - id: "WIN-AUDIT-010"
    control_id: "WIN.AUD.LOGON"
    category: "Advanced Audit"
    description: "Audit Logon events"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'Logon') -match 'Success.*Enabled' -and (AuditPol /get /subcategory:'Logon') -match 'Failure.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'Logon' /success:enable /failure:enable"]
    severity: "medium"
    os: "windows"
  - id: "WIN-AUDIT-011"
    control_id: "WIN.AUD.OBJECT_ACCESS"
    category: "Advanced Audit"
    description: "Audit Object Access (File System)"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'File System') -match 'Success.*Enabled' -and (AuditPol /get /subcategory:'File System') -match 'Failure.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'File System' /success:enable /failure:enable"]
    severity: "medium"
    os: "windows"
  - id: "WIN-AUDIT-012"
    control_id: "WIN.AUD.DETAILED_TRACKING"
    category: "Advanced Audit"
    description: "Audit Detailed Tracking (Process Creation)"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'Process Creation') -match 'Success.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'Process Creation' /success:enable"]
    severity: "medium"
    os: "windows"
  - id: "WIN-DEF-002"
    control_id: "WIN.DEF.APPGUARD_SETTINGS"
    category: "Application Guard"
    description: "MDAG: Clipboard/Camera/Mic restrictions"
    check_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'MDAG settings require MDM/GPO verification'; $true"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Configure MDAG settings via GPO/MDM'; exit 0"]
    severity: "low"
    os: "windows"
  - id: "WIN-AUDIT-013"
    control_id: "WIN.AUD.LOGOFF"
    category: "Advanced Audit"
    description: "Audit Logoff events"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'Logoff') -match 'Success.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'Logoff' /success:enable"]
    severity: "medium"
    os: "windows"
  - id: "WIN-AUDIT-014"
    control_id: "WIN.AUD.ACCOUNT_MGMT"
    category: "Advanced Audit"
    description: "Audit Account Management (User/Computer/Group Account Management)"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'User Account Management') -match 'Success.*Enabled' -and (AuditPol /get /subcategory:'Computer Account Management') -match 'Success.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'User Account Management' /success:enable /failure:enable; AuditPol /set /subcategory:'Computer Account Management' /success:enable /failure:enable"]
    severity: "high"
    os: "windows"
  - id: "WIN-AUDIT-015"
    control_id: "WIN.AUD.REGISTRY"
    category: "Advanced Audit"
    description: "Audit Object Access - Registry"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'Registry') -match 'Success.*Enabled' -and (AuditPol /get /subcategory:'Registry') -match 'Failure.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'Registry' /success:enable /failure:enable"]
    severity: "medium"
    os: "windows"
  - id: "WIN-AUDIT-016"
    control_id: "WIN.AUD.RPC_EVENTS"
    category: "Advanced Audit"
    description: "Audit Detailed Tracking - RPC Events"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'RPC Events') -match 'Success.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'RPC Events' /success:enable"]
    severity: "low"
    os: "windows"
  - id: "WIN-AUDIT-017"
    control_id: "WIN.AUD.SECURITY_STATE"
    category: "Advanced Audit"
    description: "Audit System - Security State Change"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'Security State Change') -match 'Success.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'Security State Change' /success:enable"]
    severity: "high"
    os: "windows"
  - id: "WIN-AUDIT-018"
    control_id: "WIN.AUD.ACCOUNT_LOCKOUT"
    category: "Advanced Audit"
    description: "Audit Account Lockout events"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(AuditPol /get /subcategory:'Account Lockout') -match 'Failure.*Enabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "AuditPol /set /subcategory:'Account Lockout' /failure:enable"]
    severity: "high"
    os: "windows"
  - id: "WIN-SVC-018"
    control_id: "WIN.SVC.PRINT_SPOOLER"
    category: "System Services"
    description: "Print Spooler disabled (if not needed)"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-Service Spooler).StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-Service -Name Spooler -StartupType Disabled"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SVC-019"
    control_id: "WIN.SVC.WINDOWS_SEARCH"
    category: "System Services"
    description: "Windows Search disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-Service WSearch).StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-Service -Name WSearch -StartupType Disabled"]
    severity: "low"
    os: "windows"
  - id: "WIN-SVC-020"
    control_id: "WIN.SVC.HOMEGROUP_LISTENER"
    category: "System Services"
    description: "HomeGroup Listener disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$s=Get-Service HomeGroupListener -ErrorAction SilentlyContinue; !$s -or $s.StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "$s=Get-Service HomeGroupListener -ErrorAction SilentlyContinue; if($s){ Set-Service -Name HomeGroupListener -StartupType Disabled }"]
    severity: "low"
    os: "windows"
  - id: "WIN-SVC-021"
    control_id: "WIN.SVC.HOMEGROUP_PROVIDER"
    category: "System Services"
    description: "HomeGroup Provider disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$s=Get-Service HomeGroupProvider -ErrorAction SilentlyContinue; !$s -or $s.StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "$s=Get-Service HomeGroupProvider -ErrorAction SilentlyContinue; if($s){ Set-Service -Name HomeGroupProvider -StartupType Disabled }"]
    severity: "low"
    os: "windows"
  - id: "WIN-SVC-022"
    control_id: "WIN.SVC.RDP_CONFIG"
    category: "System Services"
    description: "Remote Desktop Configuration disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$s=Get-Service SessionEnv -ErrorAction SilentlyContinue; !$s -or $s.StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "$s=Get-Service SessionEnv -ErrorAction SilentlyContinue; if($s){ Set-Service -Name SessionEnv -StartupType Disabled }"]
    severity: "medium"
    os: "windows"
  - id: "WIN-SVC-023"
    control_id: "WIN.SVC.RIP_LISTENER"
    category: "System Services"
    description: "RIP Listener disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$s=Get-Service iprip -ErrorAction SilentlyContinue; !$s -or $s.StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "$s=Get-Service iprip -ErrorAction SilentlyContinue; if($s){ Set-Service -Name iprip -StartupType Disabled }"]
    severity: "low"
    os: "windows"
  - id: "WIN-SVC-024"
    control_id: "WIN.SVC.SIMPLE_TCPIP"
    category: "System Services"
    description: "Simple TCP/IP Services disabled"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$s=Get-Service simptcp -ErrorAction SilentlyContinue; !$s -or $s.StartType -eq 'Disabled'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "$s=Get-Service simptcp -ErrorAction SilentlyContinue; if($s){ Set-Service -Name simptcp -StartupType Disabled }"]
    severity: "low"
    os: "windows"
  - id: "WIN-SVC-025"
    control_id: "WIN.SVC.WINDOWS_LICENSE"
    category: "System Services"
    description: "Windows License Manager Service disabled (if not needed)"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$s=Get-Service LicenseManager -ErrorAction SilentlyContinue; !$s -or $s.StartType -eq 'Manual'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Set LicenseManager to Manual if licensing not required'; exit 0"]
    severity: "low"
    os: "windows"
  - id: "WIN-RIGHTS-010"
    control_id: "WIN.RIGHTS.SHUTDOWN"
    category: "Local Policies"
    description: "Shutdown system: Administrators only"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; (Select-String -Path $cfg -Pattern 'SeShutdownPrivilege').Line -match 'S-1-5-32-544'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Configure SeShutdownPrivilege to Administrators only via Local Security Policy'; exit 1"]
    severity: "medium"
    os: "windows"
  - id: "WIN-RIGHTS-011"
    control_id: "WIN.RIGHTS.TAKE_OWNERSHIP"
    category: "Local Policies"
    description: "Take ownership: Administrators only"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; (Select-String -Path $cfg -Pattern 'SeTakeOwnershipPrivilege').Line -match 'S-1-5-32-544'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Configure SeTakeOwnershipPrivilege to Administrators only'; exit 1"]
    severity: "high"
    os: "windows"
  - id: "WIN-RIGHTS-012"
    control_id: "WIN.RIGHTS.LOAD_DRIVER"
    category: "Local Policies"
    description: "Load/unload device drivers: Administrators only"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; (Select-String -Path $cfg -Pattern 'SeLoadDriverPrivilege').Line -match 'S-1-5-32-544'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Configure SeLoadDriverPrivilege to Administrators only'; exit 1"]
    severity: "high"
    os: "windows"
  - id: "WIN-RIGHTS-013"
    control_id: "WIN.RIGHTS.DEBUG"
    category: "Local Policies"
    description: "Debug programs: Administrators only"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; (Select-String -Path $cfg -Pattern 'SeDebugPrivilege').Line -match 'S-1-5-32-544'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Configure SeDebugPrivilege to Administrators only'; exit 1"]
    severity: "high"
    os: "windows"
  - id: "WIN-RIGHTS-014"
    control_id: "WIN.RIGHTS.IMPERSONATE"
    category: "Local Policies"
    description: "Impersonate a client: Administrators, Service accounts"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; (Select-String -Path $cfg -Pattern 'SeImpersonatePrivilege').Line -match 'S-1-5-32-544'"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Configure SeImpersonatePrivilege appropriately'; exit 1"]
    severity: "medium"
    os: "windows"
  - id: "WIN-RIGHTS-015"
    control_id: "WIN.RIGHTS.CREATE_TOKEN"
    category: "Local Policies"
    description: "Create a token object: No one"
    check_cmd: ["powershell", "-NoProfile", "-Command", "$cfg=$env:TEMP+'\\secpol.cfg'; secedit /export /cfg $cfg | Out-Null; -not (Select-String -Path $cfg -Pattern 'SeCreateTokenPrivilege')"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Write-Host 'Set SeCreateTokenPrivilege to empty via Local Security Policy'; exit 1"]
    severity: "high"
    os: "windows"
  - id: "WIN-SEC-009"
    control_id: "WIN.SEC.NO_LAST_USER"
    category: "Security Options"
    description: "Do not display last user name"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System').DontDisplayLastUserName -eq 1"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System' -Name 'DontDisplayLastUserName' -Value 1"]
    severity: "low"
    os: "windows"
  - id: "WIN-SEC-010"
    control_id: "WIN.SEC.LOGON_MESSAGE_TITLE"
    category: "Security Options"
    description: "Logon message title configured"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System').LegalNoticeCaption -ne $null"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System' -Name 'LegalNoticeCaption' -Value 'Warning'"]
    severity: "low"
    os: "windows"
  - id: "WIN-SEC-011"
    control_id: "WIN.SEC.MACHINE_PWD_AGE"
    category: "Security Options"
    description: "Maximum machine account password age <= 30 days"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(Get-ItemProperty 'HKLM:\\SYSTEM\\CurrentControlSet\\Services\\Netlogon\\Parameters').MaximumPasswordAge -le 30"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "Set-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Services\\Netlogon\\Parameters' -Name 'MaximumPasswordAge' -Value 30"]
    severity: "medium"
    os: "windows"
  - id: "WIN-LOCK-004"
    control_id: "WIN.LOCK.OBSERVATION_WINDOW"
    category: "Account Lockout"
    description: "Account lockout observation window >= 15 minutes"
    check_cmd: ["powershell", "-NoProfile", "-Command", "(net accounts) -match 'Lockout observation window' | ForEach-Object {($_ -split ':')[1].Trim()} | ForEach-Object {[timespan]::Parse($_).Minutes -ge 15}"]
    fix_cmd: ["powershell", "-NoProfile", "-Command", "net accounts /lockoutwindow:15"]
    severity: "medium"
    os: "windows"